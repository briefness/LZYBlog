import{_ as s,o as e,c as i,ag as t}from"./chunks/framework.CbQjVMS6.js";const g=JSON.parse('{"title":"Coze 零基础精通系列 06：数据库 (Database)与变量 —— 让 AI 记住你是谁","description":"","frontmatter":{},"headers":[],"relativePath":"posts/coze/06_Database_Memory.md","filePath":"posts/coze/06_Database_Memory.md"}'),n={name:"posts/coze/06_Database_Memory.md"};function l(o,a,r,p,d,h){return e(),i("div",null,[...a[0]||(a[0]=[t(`<h1 id="coze-零基础精通系列-06-数据库-database-与变量-——-让-ai-记住你是谁" tabindex="-1">Coze 零基础精通系列 06：数据库 (Database)与变量 —— 让 AI 记住你是谁 <a class="header-anchor" href="#coze-零基础精通系列-06-数据库-database-与变量-——-让-ai-记住你是谁" aria-label="Permalink to &quot;Coze 零基础精通系列 06：数据库 (Database)与变量 —— 让 AI 记住你是谁&quot;">​</a></h1><blockquote><p><strong>上一篇回顾</strong>：AI 已经能联网、能画图了。<br><strong>本篇目标</strong>：解决 AI“聊完就忘”的问题，赋予它<strong>永久记忆</strong>。</p></blockquote><hr><h2 id="_1-为什么-ai-像-金鱼" tabindex="-1">1. 为什么 AI 像“金鱼”？ <a class="header-anchor" href="#_1-为什么-ai-像-金鱼" aria-label="Permalink to &quot;1. 为什么 AI 像“金鱼”？&quot;">​</a></h2><p>虽然 Coze 有上下文记忆，但在常规对话中，如果告诉它“我叫小明，对花生过敏”，过了一个礼拜再回来找它（开启新对话），它就不认识了。 这是因为 <strong>Token 上下文</strong> 是昂贵且有限的，而且通常只存在于当前会话窗口中。</p><p>如果要做一个：</p><ul><li><strong>记账助手</strong>（需要存每一笔钱）</li><li><strong>打卡应用</strong>（需要记录坚持了多少天）</li><li><strong>会员系统</strong>（需要识别金牌用户）</li></ul><p>必须使用 <strong>数据库 (Database)</strong>。</p><h2 id="_2-核心原理-变量-vs-数据库" tabindex="-1">2. 核心原理：变量 vs 数据库 <a class="header-anchor" href="#_2-核心原理-变量-vs-数据库" aria-label="Permalink to &quot;2. 核心原理：变量 vs 数据库&quot;">​</a></h2><p>在 Coze 里，存储数据有两种方式，就像“便利贴”和“档案柜”。</p><h3 id="_2-1-变量-variable-——-便利贴" tabindex="-1">2.1 变量 (Variable) —— 便利贴 <a class="header-anchor" href="#_2-1-变量-variable-——-便利贴" aria-label="Permalink to &quot;2.1 变量 (Variable) —— 便利贴&quot;">​</a></h3><ul><li><strong>特点</strong>：存取快，适合存简单的东西（如用户偏好语言、当前心情）。</li><li><strong>生命周期</strong>：可以是本次对话有效，也可以是长期有效。</li><li><strong>原理</strong>：Key-Value 键值对（<code>language = &quot;English&quot;</code>）。</li></ul><h3 id="_2-2-数据库-database-——-档案柜" tabindex="-1">2.2 数据库 (Database) —— 档案柜 <a class="header-anchor" href="#_2-2-数据库-database-——-档案柜" aria-label="Permalink to &quot;2.2 数据库 (Database) —— 档案柜&quot;">​</a></h3><ul><li><strong>特点</strong>：结构化存储，适合存大量、复杂的数据（如 1000 条消费记录）。</li><li><strong>原理</strong>：类似 Excel 表格。有行（Row）有列（Column）。</li><li><strong>操作</strong>：增（Add）、删（Delete）、改（Update）、查（Query）。</li></ul><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">graph TD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    User([&quot;用户输入: &#39;记一笔，午饭 50 元&#39;&quot;]) --&gt; Intent{意图判断}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph Memory_System [Coze 记忆系统]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        direction TB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Var[&quot;变量 (Variables)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        DB[(&quot;数据库 (Database)&quot;)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Intent --&gt;|简单偏好| Var</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Intent --&gt;|结构化数据| DB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Var --&gt;|读取: 如用户昵称| Response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DB --&gt;|读取: 统计本周消费| Response</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Response[Bot 回复] --&gt; User</span></span></code></pre></div><h2 id="_3-实战案例-制作-私人记账助手" tabindex="-1">3. 实战案例：制作“私人记账助手” <a class="header-anchor" href="#_3-实战案例-制作-私人记账助手" aria-label="Permalink to &quot;3. 实战案例：制作“私人记账助手”&quot;">​</a></h2><p>功能目标：如果不说话，它不知道花了多少钱；一问它，它能从数据库里算出来。</p><h3 id="第一步-创建数据表" tabindex="-1">第一步：创建数据表 <a class="header-anchor" href="#第一步-创建数据表" aria-label="Permalink to &quot;第一步：创建数据表&quot;">​</a></h3><ol><li>在 Bot 编排页面，点击 <strong>“数据库”</strong> -&gt; <code>+</code> -&gt; <strong>“创建数据表”</strong>。</li><li>表名：<code>expense_table</code>。</li><li>添加字段（列）： <ul><li><code>user_id</code> (文本)：记录用户身份，防止数据混淆。</li><li><code>amount</code> (数字)：金额。</li><li><code>category</code> (文本)：分类（如餐饮、交通）。</li><li><code>date</code> (文本)：时间。</li></ul></li><li>这里的 <code>user_id</code> 很关键，Coze 会自动提供当前用户的 ID。</li></ol><blockquote><p>💡 <strong>进阶技巧</strong>：调试时如果有数据存入疑问，可以打开 <strong>Coze 数据库后台</strong>。它提供了一个类似 Excel 的可视化界面，允许开发者直接查看、修改和删除数据，对 Debug 极大方便。</p></blockquote><h3 id="第二步-创建-记账-工作流" tabindex="-1">第二步：创建“记账”工作流 <a class="header-anchor" href="#第二步-创建-记账-工作流" aria-label="Permalink to &quot;第二步：创建“记账”工作流&quot;">​</a></h3><p>需要一个 Workflow 来把数据写入表里。</p><ol><li>创建工作流 <code>record_expense</code>。</li><li><strong>Start 节点</strong>：接收参数 <code>amount</code>, <code>category</code>。</li><li><strong>Database 节点</strong>（在左侧菜单找）： <ul><li>选择操作：<strong>插入 (Insert)</strong>。</li><li>选择表：<code>expense_table</code>。</li><li>字段映射：把 Start 节点的参数对应填入表字段。</li><li><code>user_id</code> 字段引用系统变量 <code>Session.User_Id</code>。</li></ul></li><li><strong>End 节点</strong>：返回“记账成功”。</li></ol><h3 id="第三步-创建-查账-工作流" tabindex="-1">第三步：创建“查账”工作流 <a class="header-anchor" href="#第三步-创建-查账-工作流" aria-label="Permalink to &quot;第三步：创建“查账”工作流&quot;">​</a></h3><p>需要另一个 Workflow 来算账。</p><ol><li>创建工作流 <code>query_expense</code>。</li><li><strong>Database 节点</strong>： <ul><li>选择操作：<strong>查询 (Select)</strong>。</li><li>条件：<code>user_id</code> 等于 <code>Session.User_Id</code>。</li></ul></li><li><strong>Code 节点</strong> (或者 LLM 节点)： <ul><li>因为数据库查出来是多行数据，我们需要算总和。</li><li>可以用一个简单的 Python 代码节点来把 list 里的 amount 加起来。</li><li><em>(若不写代码，也可以直接扔给 LLM 节点让它算)</em>。</li></ul></li><li><strong>End 节点</strong>：返回总金额。</li></ol><h3 id="第四步-prompt-粘合" tabindex="-1">第四步：Prompt 粘合 <a class="header-anchor" href="#第四步-prompt-粘合" aria-label="Permalink to &quot;第四步：Prompt 粘合&quot;">​</a></h3><p>在 Bot 的 Prompt 里写：</p><div class="language-markdown vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-light-font-weight:bold;--shiki-dark:#79B8FF;--shiki-dark-font-weight:bold;"># Skills</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">1.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 当用户说“花了多少钱”等记录指令时，调用 record_expense 工作流。</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">2.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 当用户问“总共花了多少”时，调用 query_expense 工作流。</span></span></code></pre></div><hr><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>有了数据库，AI 就有了<strong>积累</strong>的能力。这赋予了 Bot 长期记忆能力，使其能提供连续的服务。</p><p>到目前为止，教程已涵盖 Coze 的 80% 能力。 但若想做更极客的功能（比如处理复杂的 JSON 数据，或者进行复杂的数学运算），单纯靠拖拽节点可能不够灵活。 下一篇，将引入 <strong>代码节点 (Code Node)</strong>，介绍如何用简单的代码，解决 No-Code 难以处理的问题。</p>`,33)])])}const k=s(n,[["render",l]]);export{g as __pageData,k as default};
