# Coze 零基础精通系列 15：扣子罗盘 (Compass) —— 如何科学地评测与优化 Agent？

> **上一篇回顾**：Bot 已具备漂亮的“外衣”(UI Cards)。
> **本篇目标**：外表再美，若回答质量不佳也是徒劳。本篇介绍 **Coze 扣子罗盘**，这是企业级开发必不可少的 **AgentOps** 工具，解析如何从“凭感觉测试”进阶到“数据化评测”。

---

## 1. 为什么需要“罗盘”？

在前面的教程中，常见的测试 Bot 方式通常是：
> 在预览窗口提问几个问题（如“你好吗？”、“明天天气怎样？”），若回答看似无误，便进行发布。

**这种“凭感觉”测试存在巨大隐患：**
1.  **覆盖率低**：测试覆盖率往往有限，少量问题无法代表用户的海量问法。
2.  **回归效应**：调整 Prompt 优化 A 问题时，可能意外导致 B 问题回答错误（即回归效应），且未被察觉。
3.  **盲盒运营**：Bot 发布后，Token 消耗量、报错分布等数据一概不知。

**扣子罗盘 (Coze Compass)** 是专为解决此类问题而生的 **全生命周期监控与评估平台**。

---

## 2. 核心功能一：批量评测 (Evaluation)

这是罗盘最强大的功能。该功能允许建立一个“测试集”，让 AI 进行自我检测。

### 第一步：建立测试集 (Dataset)
需准备一个 Excel 或 CSV，包含两列：
*   **Input**：用户的问题（如：“三亚希尔顿多少钱？”）
*   **Expected Output**（可选）：标准答案（如：“1500元”）。

### 第二步：发起评测
1.  在 Coze 界面点击 **“罗盘”** 图标，进入评测页面。
2.  点击 `+ 新建评测`。
3.  选择目标 Bot，导入测试集。
4.  选择 **评分维度**。Coze 内置了多个 AI 裁判：
    *   **准确性 (Accuracy)**：回答是否与事实相符。
    *   **相关性 (Relevance)**：是否答非所问。
    *   **安全性 (Safety)**：是否包含违规内容。

### 第三步：查看报告
点击运行后，Bot 会自动回答测试集里的 50 个问题，并由评分 AI 对每个回答打分（0-100分）。
最终将生成一个总分报告。

> 💡 **最佳实践**：每次修改 Prompt 后，建议运行评测。若分数从 85 降至 80，说明修改产生负面影响，**不应发布**。

---

## 3. 核心功能二：全链路监控 (Observability)

Bot 上线后，需实时监控其健康状况。

### 1. 概览大屏 (Dashboard)
此处展示 Bot 的核心指标：
*   **消息数 (Message Count)**：当日对话量。
*   **活跃用户数 (DAU)**：不重复用户数量。
*   **Token 消耗**：成本消耗数据。

### 2. 详细日志 (Log & Trace)
这是排查 Bug 的关键工具。
当收到“回复卡顿”或者“回答异常”的反馈时，操作如下：
1.  进入 **日志 (Log)** 页面。
2.  通过时间或用户 ID 检索对话。
3.  点开 **Trace (调用链)** 视图。这是一个瀑布图，精确显示：
    *   用户发送消息（0ms）
    *   检索知识库（耗时 500ms，**查获 3 条数据**）
    *   调用天气插件（耗时 2000ms，**报错 timeout**）← **定位问题源头！**
    *   LLM 生成回答（耗时 3000ms）

---

## 4. 核心功能三：Prompt 优化器

若评测分数不理想，罗盘提供 **Prompt 优化工具**。
只需输入现有 Prompt，点击“优化”。
罗盘将利用大模型能力，自动运用 **CoT (思维链)**、**Few-Shot (少样本)** 等高级技巧，重写一段更强、更稳定的 Prompt。

**这如同身边有一位资深的 AI 工程师协助修改代码。**

---

## 5. 实战流程：AgentOps 工作流

成熟 AI 团队的日常工作流程如下：

1.  **开发 (Dev)**：在 IDE 中修改 Prompt 或代码。
2.  **评测 (Eval)**：提交至罗盘，运行标准测试集。
3.  **验证 (Check)**：
    *   分数提升：发布上线 (Publish)。
    *   分数下降：退回修改。
4.  **监控 (Monitor)**：上线后，查看罗盘日志，发现“Bad Case”（如回答失败的问题）。
5.  **迭代 (Iterate)**：将 Bad Case 加入测试集，回到第 1 步。

---

## 6. 总结

制作 Demo 易，打造产品难。
**Coze 罗盘** 将 AI 开发从“经验主义”转变为“数据驱动”。

*   不依赖直觉，依赖**数据**。
*   不等待用户投诉，通过**评测**提前拦截问题。

掌握罗盘，即掌握了控制 AI 质量的关键。

---

> 下一篇，将深入代码底层，为硬核开发者带来 **Coze API 与 SDK** 的深度编程指南。
